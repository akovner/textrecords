id: http://alexkovner.com/textrecord
$schema: http://json-schema.org/draft-04/schema#
title: Text Record
description: A data record, formated as fixed-width or delimited text
type: object
oneOf:
  - properties:
      delimiter:
        type: string
        minLength: 1
        maxLength: 1
        default: ','
      stringFormat:
        enum:
          - json
          - doublequote
        default: json
      properties:
        oneOf:
          - type: object
            additionalProperties:
              type: object
              properties:
                type:
                  $ref: '#/definitions/typeEnum'
                location:
                  type: integer
                  minimum: 1
              required: [type, location]
          - type: array
            items:
              type: object
              properties:
                name:
                  type: string
                type:
                  $ref: '#/definitions/typeEnum'
              required: [name, type]
    required: [properties]
  - properties:
      properties:
        oneOf:
          - type: object
            additionalProperties:
              type: object
              properties:
                type:
                  $ref: '#/definitions/typeEnum'
                start:
                  type: integer
                end:
                  type: integer
                padding:
                  type: object
                  $ref: '#/definitions/alignment'
              required: [type, start, end]
          - type: array
            items:
              type: object
              properties:
                name:
                  type: string
                type:
                  $ref: '#/definitions/typeEnum'
                length:
                  type: integer
              required: [name, type, length]
    required: [properties]
definitions:
  typeEnum:
    enum:
      - string
      - integer
      - numeric
  alignment:
    padChar:
      type: string
      minLength: 1
      maxLength: 1
    alignment:
      enum:
        - left
        - right
